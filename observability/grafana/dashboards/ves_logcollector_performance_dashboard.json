{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": { "type": "grafana", "uid": "-- Grafana --" },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "liveNow": false,
  "refresh": "10s",
  "schemaVersion": 42,
  "style": "dark",
  "tags": ["ves", "logcollector", "observability"],
  "templating": { "list": [] },
  "time": { "from": "now-6h", "to": "now" },
  "timepicker": {},
  "timezone": "",
  "title": "VES Log Collector Full Observability",
  "uid": "ves-logcollector-full",
  "version": 2,
  "panels": [
    {
      "type": "gauge",
      "title": "Throughput (logs/sec/core)",
      "targets": [
        {
          "expr": "logcollector_throughput_logs_per_sec"
        }
      ],
      "options": {
        "thresholds": {
          "mode": "absolute",
          "steps": [
            { "color": "red", "value": null },
            { "color": "yellow", "value": 600000 },
            { "color": "green", "value": 800000 }
          ]
        }
      }
    },

    {
      "type": "gauge",
      "title": "Average Latency (ms)",
      "targets": [
        {
          "expr": "(rate(logcollector_process_line_duration_seconds_sum[1m]) / rate(logcollector_process_line_duration_seconds_count[1m])) * 1000"
        }
      ],
      "options": {
        "thresholds": {
          "mode": "absolute",
          "steps": [
            { "color": "green", "value": null },
            { "color": "yellow", "value": 0.3 },
            { "color": "red", "value": 1 }
          ]
        }
      }
    },

    {
      "type": "gauge",
      "title": "P99 Latency (ms)",
      "targets": [
        {
          "expr": "logcollector_p99_latency_ms"
        }
      ],
      "options": {
        "thresholds": {
          "mode": "absolute",
          "steps": [
            { "color": "green", "value": null },
            { "color": "yellow", "value": 0.7 },
            { "color": "red", "value": 1 }
          ]
        }
      }
    },

    {
      "type": "stat",
      "title": "Memory Footprint (MB)",
      "targets": [
        {
          "expr": "logcollector_memory_bytes / 1024 / 1024"
        }
      ],
      "options": {
        "thresholds": {
          "mode": "absolute",
          "steps": [
            { "color": "green", "value": null },
            { "color": "yellow", "value": 45 },
            { "color": "red", "value": 60 }
          ]
        }
      }
    },

    {
      "type": "stat",
      "title": "CPU Usage (%core)",
      "targets": [
        {
          "expr": "logcollector_cpu_percent_per_core"
        }
      ],
      "options": {
        "thresholds": {
          "mode": "absolute",
          "steps": [
            { "color": "green", "value": null },
            { "color": "yellow", "value": 25 },
            { "color": "red", "value": 50 }
          ]
        }
      }
    },

    {
      "type": "stat",
      "title": "Cold Start (ms)",
      "targets": [
        {
          "expr": "logcollector_startup_duration_seconds * 1000"
        }
      ],
      "options": {
        "thresholds": {
          "mode": "absolute",
          "steps": [
            { "color": "green", "value": null },
            { "color": "yellow", "value": 80 },
            { "color": "red", "value": 100 }
          ]
        }
      }
    },

    {
      "type": "stat",
      "title": "Snapshot Recovery (ms)",
      "targets": [
        {
          "expr": "logcollector_snapshot_recovery_duration_seconds * 1000"
        }
      ],
      "options": {
        "thresholds": {
          "mode": "abosolute",
          "steps": [
            { "color": "green", "value": null },
            { "color": "yellow", "value": 350 },
            { "color": "red", "value": 500 }
          ]
        }
      }
    }
  ]
}
